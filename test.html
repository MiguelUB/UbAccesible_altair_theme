
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vega-Altair Graphic</title>
    <!-- Incluye Vega y Vega-Lite desde CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
            <style>
    /* Apply background to the selector */
    option.default {
      background: linear-gradient(to right, red, blue);
      padding: 5px;
      color: white;
    }
  </style>

</head>
</head>
<body>
<div class="container mt-5">
    <!-- Selectors for Graph-->

    <div class="row ">
        <div class="col-md-6">
            <!-- Color Scheme Selector -->
            <div class="form-group my-1">
                <label for="selector">Scheme selector:</label>
                <select class="form-control" id="selector" aria-labelledby="selectorLabel">
                    <option  value="option1">Default
                    </option>
                    <option value="option2">category20b</option>
                    <option value="option3">viridis</option>
                </select>
            </div>
            <div >
                <!-- Height and Width -->
                <label for="heightGraphInput">Height:</label>
                <input type="range" id="heightGraphInput" min="0" max="1000" value="300" step="50">
                <label for="widthGraphInput">Width:</label>
                <input type="range" id="widthGraphInput" min="0" max="1000" value="300" step="50">
            </div>
                <!-- Change Text Size -->
            <div class="btn-group my-1" role="group" aria-label="Change text size">
                <button id="decreaseSizeText" class="btn btn-primary">Decrease</button>
                <button id="increaseSizeText" class="btn btn-primary">Increase</button>
            </div>
        </div>
    </div>
    <!-- Accessible Graph -->
    <div class="row my-2">
        <div class="col-md-6">
            <div id="chart"></div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <p>Layered charts does not support color schemes changes</p>
                <p>Changing size in layeres, concat, repeated, facet chart may vary the effect</p>
            </div>
        </div>
    </div>
    <!-- Basic variables -->
    <script>
        const el = document.getElementById('chart');
        let fontSizes = {"sm": 12, "md": 14, "lg": 18}
        var $heightGraphInput = $("#heightGraphInput");
        var $widthGraphInput = $("#widthGraphInput");
        var $buttonIncrease = $("#increaseSizeText");
        var $buttonDecrease = $("#decreaseSizeText");
        let spec = {"$schema": "https://vega.github.io/schema/vega-lite/v5.16.3.json", "config": {"view": {"continuousHeight": 300, "continuousWidth": 300}}, "data": {"name": "data-1487c93b91dee61ec4c167e470e512f4"}, "datasets": {"data-1487c93b91dee61ec4c167e470e512f4": [{"x": -5, "y": -5, "z": 50}, {"x": -4, "y": -5, "z": 41}, {"x": -3, "y": -5, "z": 34}, {"x": -2, "y": -5, "z": 29}, {"x": -1, "y": -5, "z": 26}, {"x": 0, "y": -5, "z": 25}, {"x": 1, "y": -5, "z": 26}, {"x": 2, "y": -5, "z": 29}, {"x": 3, "y": -5, "z": 34}, {"x": 4, "y": -5, "z": 41}, {"x": -5, "y": -4, "z": 41}, {"x": -4, "y": -4, "z": 32}, {"x": -3, "y": -4, "z": 25}, {"x": -2, "y": -4, "z": 20}, {"x": -1, "y": -4, "z": 17}, {"x": 0, "y": -4, "z": 16}, {"x": 1, "y": -4, "z": 17}, {"x": 2, "y": -4, "z": 20}, {"x": 3, "y": -4, "z": 25}, {"x": 4, "y": -4, "z": 32}, {"x": -5, "y": -3, "z": 34}, {"x": -4, "y": -3, "z": 25}, {"x": -3, "y": -3, "z": 18}, {"x": -2, "y": -3, "z": 13}, {"x": -1, "y": -3, "z": 10}, {"x": 0, "y": -3, "z": 9}, {"x": 1, "y": -3, "z": 10}, {"x": 2, "y": -3, "z": 13}, {"x": 3, "y": -3, "z": 18}, {"x": 4, "y": -3, "z": 25}, {"x": -5, "y": -2, "z": 29}, {"x": -4, "y": -2, "z": 20}, {"x": -3, "y": -2, "z": 13}, {"x": -2, "y": -2, "z": 8}, {"x": -1, "y": -2, "z": 5}, {"x": 0, "y": -2, "z": 4}, {"x": 1, "y": -2, "z": 5}, {"x": 2, "y": -2, "z": 8}, {"x": 3, "y": -2, "z": 13}, {"x": 4, "y": -2, "z": 20}, {"x": -5, "y": -1, "z": 26}, {"x": -4, "y": -1, "z": 17}, {"x": -3, "y": -1, "z": 10}, {"x": -2, "y": -1, "z": 5}, {"x": -1, "y": -1, "z": 2}, {"x": 0, "y": -1, "z": 1}, {"x": 1, "y": -1, "z": 2}, {"x": 2, "y": -1, "z": 5}, {"x": 3, "y": -1, "z": 10}, {"x": 4, "y": -1, "z": 17}, {"x": -5, "y": 0, "z": 25}, {"x": -4, "y": 0, "z": 16}, {"x": -3, "y": 0, "z": 9}, {"x": -2, "y": 0, "z": 4}, {"x": -1, "y": 0, "z": 1}, {"x": 0, "y": 0, "z": 0}, {"x": 1, "y": 0, "z": 1}, {"x": 2, "y": 0, "z": 4}, {"x": 3, "y": 0, "z": 9}, {"x": 4, "y": 0, "z": 16}, {"x": -5, "y": 1, "z": 26}, {"x": -4, "y": 1, "z": 17}, {"x": -3, "y": 1, "z": 10}, {"x": -2, "y": 1, "z": 5}, {"x": -1, "y": 1, "z": 2}, {"x": 0, "y": 1, "z": 1}, {"x": 1, "y": 1, "z": 2}, {"x": 2, "y": 1, "z": 5}, {"x": 3, "y": 1, "z": 10}, {"x": 4, "y": 1, "z": 17}, {"x": -5, "y": 2, "z": 29}, {"x": -4, "y": 2, "z": 20}, {"x": -3, "y": 2, "z": 13}, {"x": -2, "y": 2, "z": 8}, {"x": -1, "y": 2, "z": 5}, {"x": 0, "y": 2, "z": 4}, {"x": 1, "y": 2, "z": 5}, {"x": 2, "y": 2, "z": 8}, {"x": 3, "y": 2, "z": 13}, {"x": 4, "y": 2, "z": 20}, {"x": -5, "y": 3, "z": 34}, {"x": -4, "y": 3, "z": 25}, {"x": -3, "y": 3, "z": 18}, {"x": -2, "y": 3, "z": 13}, {"x": -1, "y": 3, "z": 10}, {"x": 0, "y": 3, "z": 9}, {"x": 1, "y": 3, "z": 10}, {"x": 2, "y": 3, "z": 13}, {"x": 3, "y": 3, "z": 18}, {"x": 4, "y": 3, "z": 25}, {"x": -5, "y": 4, "z": 41}, {"x": -4, "y": 4, "z": 32}, {"x": -3, "y": 4, "z": 25}, {"x": -2, "y": 4, "z": 20}, {"x": -1, "y": 4, "z": 17}, {"x": 0, "y": 4, "z": 16}, {"x": 1, "y": 4, "z": 17}, {"x": 2, "y": 4, "z": 20}, {"x": 3, "y": 4, "z": 25}, {"x": 4, "y": 4, "z": 32}]}, "encoding": {"color": {"field": "z", "type": "quantitative"}, "x": {"field": "x", "type": "ordinal"}, "y": {"field": "y", "type": "ordinal"}}, "mark": {"type": "rect"}};
        let description = "Esta es una simple descripcion"
        let embedOpt = {"mode": "vega-lite"};
        let defaultScheme = null
        if (spec.encoding.hasOwnProperty('color')) {
            if (spec.encoding.color.hasOwnProperty('scale')) {
                defaultScheme = spec.encoding.color.scale
            } else {
                spec.encoding.color["scale"] = {"scheme": "blues"}
                defaultScheme = spec.encoding.color["scale"] = {"scheme": "blues"}
            }
        }
        if(!spec.hasOwnProperty("description")){
            spec.description=description
        }

    </script>

    <!--  Auxiliar functions-->
    <script>
        function showError(el, error) {
            el.innerHTML = ('<div style="color:red;">'
                + '<p>JavaScript Error: ' + error.message + '</p>'
                + "<p>This usually means there's a typo in your chart specification. "
                + "See the javascript console for the full traceback.</p>"
                + '</div>');
            throw error;
        }

        function changeHeight() {
            let newHeight = $heightGraphInput.val();
            spec["height"] = newHeight

            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
        }

        function changeWidth() {
            let newWidth = $widthGraphInput.val();
            spec["width"] = newWidth

            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
        }

        function biggerFontSize() {
            fontSizes.sm += 2
            fontSizes.md += 2
            fontSizes.lg += 2
            // change axis size
            spec.config['axis'] = {...spec.config.axis, 'labelFontSize': fontSizes.sm, 'titleFontSize': fontSizes.md}
            // change title size
            spec.config['title'] = {...spec.config.title, 'fontSize': fontSizes.lg}
            // change legend size
            spec.config['legend'] = {
                ...spec.config.legend,
                'labelFontSize': fontSizes.sm,
                'titleFontSize': fontSizes.md
            }
            // change text mark size
            spec.config['text'] = {...spec.config.text, 'fontSize': fontSizes.sm}
            // change header size
            spec.config['header'] = {
                ...spec.config.header,
                'labelFontSize': fontSizes.sm,
                'titleFontSize': fontSizes.md
            }


            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));

        }

        function smallerFontSize() {
            fontSizes.sm -= 2
            fontSizes.md -= 2
            fontSizes.lg -= 2
            // change axis size
            spec.config['axis'] = {...spec.config.axis, 'labelFontSize': fontSizes.sm, 'titleFontSize': fontSizes.md}
            // change title size
            spec.config['title'] = {...spec.config.title, 'fontSize': fontSizes.lg}
            // change legend size
            spec.config['legend'] = {
                ...spec.config.legend,
                'labelFontSize': fontSizes.sm,
                'titleFontSize': fontSizes.md
            }
            // change text mark size
            spec.config['text'] = {...spec.config.text, 'fontSize': fontSizes.sm}
            // change header size
            spec.config['header'] = {
                ...spec.config.header,
                'labelFontSize': fontSizes.sm,
                'titleFontSize': fontSizes.md
            }
            
            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));

        }
    </script>
    
    <!-- Main sript -->
    <script>
        // Color scheme selector
        $(document).ready(function () {
            if (defaultScheme != null) {
                $('#selector').change(function () {
                    var opcionSeleccionada = $(this).val();
                    switch (opcionSeleccionada) {
                        case 'option1':
                            spec.encoding.color.scale = defaultScheme
                            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
                            break;
                        case 'option2':

                            spec.encoding.color.scale = {"scheme": "category20b"}
                            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
                            break;
                        case 'option3':
                            spec.encoding.color.scale = {"scheme": "viridis"}
                            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
                            break;
                        default:
                            console.log("The selected option does not correspond any color scheme")
                            break;

                    }

                });
            }
        });
        
        vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
        $heightGraphInput.on("input", changeHeight);
        $widthGraphInput.on("input", changeWidth);
        $buttonIncrease.on("click", biggerFontSize);
        $buttonDecrease.on("click", smallerFontSize);

    </script>
</body>
</html>

