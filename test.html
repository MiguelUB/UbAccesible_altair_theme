
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vega-Altair Graphic</title>
    <!-- Incluye Vega y Vega-Lite desde CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
            <style>
    /* Apply background to the selector */
    option.default {
      background: linear-gradient(to right, red, blue);
      padding: 5px;
      color: white;
    }
  </style>

</head>
</head>
<body>
<div class="container mt-5">
    <!-- Selectors for Graph-->

    <div class="row ">
        <div class="col-md-6">
            <!-- Color Scheme Selector -->
            <div class="form-group my-1">
                <label for="selector">Scheme selector:</label>
                <select class="form-control" id="selector" aria-labelledby="selectorLabel">
                    <option  value="option1">Default
                    </option>
                    <option value="option2">category20b</option>
                    <option value="option3">viridis</option>
                </select>
            </div>
            <div >
                <!-- Height and Width -->
                <label for="heightGraphInput">Height:</label>
                <input type="range" id="heightGraphInput" min="0" max="1000" value="300" step="50">
                <label for="widthGraphInput">Width:</label>
                <input type="range" id="widthGraphInput" min="0" max="1000" value="300" step="50">
            </div>
                <!-- Change Text Size -->
            <div class="btn-group my-1" role="group" aria-label="Change text size">
                <button id="decreaseSizeText" class="btn btn-primary">Decrease</button>
                <button id="increaseSizeText" class="btn btn-primary">Increase</button>
            </div>
        </div>
    </div>
    <!-- Accessible Graph -->
    <div class="row my-2">
        <div class="col-md-6">
            <div id="chart"></div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <p>Layered charts does not support color schemes changes</p>
                <p>Changing size in layeres, concat, repeated, facet chart may vary the effect</p>
            </div>
        </div>
    </div>
    <!-- Basic variables -->
    <script>
        const el = document.getElementById('chart');
        let fontSizes = {"sm": 12, "md": 14, "lg": 18}
        var $heightGraphInput = $("#heightGraphInput");
        var $widthGraphInput = $("#widthGraphInput");
        var $buttonIncrease = $("#increaseSizeText");
        var $buttonDecrease = $("#decreaseSizeText");
        let spec = {"$schema": "https://vega.github.io/schema/vega-lite/v5.16.3.json", "config": {"view": {"continuousHeight": 300, "continuousWidth": 300, "stroke": null}}, "datasets": {"data-043711543f32bfffffb6dc606686cfc1": [{"hi": "Hard", "lo": "Easy", "median": 1.999976, "name": "Identify Errors:"}, {"hi": "Hard", "lo": "Easy", "median": 2.0, "name": "Fix Errors:"}, {"hi": "Gesture", "lo": "Toolbar", "median": 1.999969, "name": "Easier to Fix:"}, {"hi": "Gesture", "lo": "Toolbar", "median": 2.500045, "name": "Faster to Fix:"}, {"hi": "Gesture", "lo": "Toolbar", "median": 1.500022, "name": "Easier on Phone:"}, {"hi": "Gesture", "lo": "Toolbar", "median": 2.99998, "name": "Easier on Tablet:"}, {"hi": "Tablet", "lo": "Phone", "median": 4.500007, "name": "Device Preference:"}], "data-4fe62194e0628f05faa71d2e19ccd79a": [{"id": "P1", "name": "Participant ID", "value": "P1"}, {"id": "P1", "name": "Identify Errors:", "value": 2}, {"id": "P1", "name": "Fix Errors:", "value": 2}, {"id": "P1", "name": "Easier to Fix:", "value": 3}, {"id": "P1", "name": "Faster to Fix:", "value": 4}, {"id": "P1", "name": "Easier on Phone:", "value": 2}, {"id": "P1", "name": "Easier on Tablet:", "value": 5}, {"id": "P1", "name": "Device Preference:", "value": 5}, {"id": "P1", "name": "Tablet_First", "value": 1}, {"id": "P1", "name": "Toolbar_First", "value": 1}, {"id": "P2", "name": "Participant ID", "value": "P2"}, {"id": "P2", "name": "Identify Errors:", "value": 2}, {"id": "P2", "name": "Fix Errors:", "value": 3}, {"id": "P2", "name": "Easier to Fix:", "value": 4}, {"id": "P2", "name": "Faster to Fix:", "value": 5}, {"id": "P2", "name": "Easier on Phone:", "value": 5}, {"id": "P2", "name": "Easier on Tablet:", "value": 5}, {"id": "P2", "name": "Device Preference:", "value": 5}, {"id": "P2", "name": "Tablet_First", "value": 1}, {"id": "P2", "name": "Toolbar_First", "value": 1}, {"id": "P3", "name": "Participant ID", "value": "P3"}, {"id": "P3", "name": "Identify Errors:", "value": 2}, {"id": "P3", "name": "Fix Errors:", "value": 2}, {"id": "P3", "name": "Easier to Fix:", "value": 2}, {"id": "P3", "name": "Faster to Fix:", "value": 1}, {"id": "P3", "name": "Easier on Phone:", "value": 2}, {"id": "P3", "name": "Easier on Tablet:", "value": 1}, {"id": "P3", "name": "Device Preference:", "value": 5}, {"id": "P3", "name": "Tablet_First", "value": 1}, {"id": "P3", "name": "Toolbar_First", "value": 0}, {"id": "P4", "name": "Participant ID", "value": "P4"}, {"id": "P4", "name": "Identify Errors:", "value": 3}, {"id": "P4", "name": "Fix Errors:", "value": 3}, {"id": "P4", "name": "Easier to Fix:", "value": 2}, {"id": "P4", "name": "Faster to Fix:", "value": 2}, {"id": "P4", "name": "Easier on Phone:", "value": 4}, {"id": "P4", "name": "Easier on Tablet:", "value": 1}, {"id": "P4", "name": "Device Preference:", "value": 5}, {"id": "P4", "name": "Tablet_First", "value": 1}, {"id": "P4", "name": "Toolbar_First", "value": 0}, {"id": "P5", "name": "Participant ID", "value": "P5"}, {"id": "P5", "name": "Identify Errors:", "value": 2}, {"id": "P5", "name": "Fix Errors:", "value": 2}, {"id": "P5", "name": "Easier to Fix:", "value": 4}, {"id": "P5", "name": "Faster to Fix:", "value": 4}, {"id": "P5", "name": "Easier on Phone:", "value": 4}, {"id": "P5", "name": "Easier on Tablet:", "value": 5}, {"id": "P5", "name": "Device Preference:", "value": 5}, {"id": "P5", "name": "Tablet_First", "value": 0}, {"id": "P5", "name": "Toolbar_First", "value": 1}, {"id": "P6", "name": "Participant ID", "value": "P6"}, {"id": "P6", "name": "Identify Errors:", "value": 1}, {"id": "P6", "name": "Fix Errors:", "value": 3}, {"id": "P6", "name": "Easier to Fix:", "value": 3}, {"id": "P6", "name": "Faster to Fix:", "value": 4}, {"id": "P6", "name": "Easier on Phone:", "value": 4}, {"id": "P6", "name": "Easier on Tablet:", "value": 4}, {"id": "P6", "name": "Device Preference:", "value": 4}, {"id": "P6", "name": "Tablet_First", "value": 0}, {"id": "P6", "name": "Toolbar_First", "value": 1}, {"id": "P7", "name": "Participant ID", "value": "P7"}, {"id": "P7", "name": "Identify Errors:", "value": 2}, {"id": "P7", "name": "Fix Errors:", "value": 3}, {"id": "P7", "name": "Easier to Fix:", "value": 4}, {"id": "P7", "name": "Faster to Fix:", "value": 5}, {"id": "P7", "name": "Easier on Phone:", "value": 3}, {"id": "P7", "name": "Easier on Tablet:", "value": 2}, {"id": "P7", "name": "Device Preference:", "value": 4}, {"id": "P7", "name": "Tablet_First", "value": 0}, {"id": "P7", "name": "Toolbar_First", "value": 0}, {"id": "P8", "name": "Participant ID", "value": "P8"}, {"id": "P8", "name": "Identify Errors:", "value": 3}, {"id": "P8", "name": "Fix Errors:", "value": 1}, {"id": "P8", "name": "Easier to Fix:", "value": 2}, {"id": "P8", "name": "Faster to Fix:", "value": 4}, {"id": "P8", "name": "Easier on Phone:", "value": 2}, {"id": "P8", "name": "Easier on Tablet:", "value": 5}, {"id": "P8", "name": "Device Preference:", "value": 5}, {"id": "P8", "name": "Tablet_First", "value": 0}, {"id": "P8", "name": "Toolbar_First", "value": 0}, {"id": "P9", "name": "Participant ID", "value": "P9"}, {"id": "P9", "name": "Identify Errors:", "value": 2}, {"id": "P9", "name": "Fix Errors:", "value": 3}, {"id": "P9", "name": "Easier to Fix:", "value": 2}, {"id": "P9", "name": "Faster to Fix:", "value": 4}, {"id": "P9", "name": "Easier on Phone:", "value": 1}, {"id": "P9", "name": "Easier on Tablet:", "value": 4}, {"id": "P9", "name": "Device Preference:", "value": 4}, {"id": "P9", "name": "Tablet_First", "value": 1}, {"id": "P9", "name": "Toolbar_First", "value": 1}, {"id": "P10", "name": "Participant ID", "value": "P10"}, {"id": "P10", "name": "Identify Errors:", "value": 2}, {"id": "P10", "name": "Fix Errors:", "value": 2}, {"id": "P10", "name": "Easier to Fix:", "value": 1}, {"id": "P10", "name": "Faster to Fix:", "value": 1}, {"id": "P10", "name": "Easier on Phone:", "value": 1}, {"id": "P10", "name": "Easier on Tablet:", "value": 1}, {"id": "P10", "name": "Device Preference:", "value": 5}, {"id": "P10", "name": "Tablet_First", "value": 1}, {"id": "P10", "name": "Toolbar_First", "value": 1}, {"id": "P11", "name": "Participant ID", "value": "P11"}, {"id": "P11", "name": "Identify Errors:", "value": 2}, {"id": "P11", "name": "Fix Errors:", "value": 2}, {"id": "P11", "name": "Easier to Fix:", "value": 1}, {"id": "P11", "name": "Faster to Fix:", "value": 1}, {"id": "P11", "name": "Easier on Phone:", "value": 1}, {"id": "P11", "name": "Easier on Tablet:", "value": 1}, {"id": "P11", "name": "Device Preference:", "value": 4}, {"id": "P11", "name": "Tablet_First", "value": 1}, {"id": "P11", "name": "Toolbar_First", "value": 0}, {"id": "P12", "name": "Participant ID", "value": "P12"}, {"id": "P12", "name": "Identify Errors:", "value": 1}, {"id": "P12", "name": "Fix Errors:", "value": 3}, {"id": "P12", "name": "Easier to Fix:", "value": 2}, {"id": "P12", "name": "Faster to Fix:", "value": 3}, {"id": "P12", "name": "Easier on Phone:", "value": 1}, {"id": "P12", "name": "Easier on Tablet:", "value": 3}, {"id": "P12", "name": "Device Preference:", "value": 3}, {"id": "P12", "name": "Tablet_First", "value": 0}, {"id": "P12", "name": "Toolbar_First", "value": 1}, {"id": "P13", "name": "Participant ID", "value": "P13"}, {"id": "P13", "name": "Identify Errors:", "value": 2}, {"id": "P13", "name": "Fix Errors:", "value": 2}, {"id": "P13", "name": "Easier to Fix:", "value": 1}, {"id": "P13", "name": "Faster to Fix:", "value": 1}, {"id": "P13", "name": "Easier on Phone:", "value": 1}, {"id": "P13", "name": "Easier on Tablet:", "value": 1}, {"id": "P13", "name": "Device Preference:", "value": 5}, {"id": "P13", "name": "Tablet_First", "value": 0}, {"id": "P13", "name": "Toolbar_First", "value": 0}, {"id": "P14", "name": "Participant ID", "value": "P14"}, {"id": "P14", "name": "Identify Errors:", "value": 3}, {"id": "P14", "name": "Fix Errors:", "value": 3}, {"id": "P14", "name": "Easier to Fix:", "value": 2}, {"id": "P14", "name": "Faster to Fix:", "value": 2}, {"id": "P14", "name": "Easier on Phone:", "value": 1}, {"id": "P14", "name": "Easier on Tablet:", "value": 1}, {"id": "P14", "name": "Device Preference:", "value": 1}, {"id": "P14", "name": "Tablet_First", "value": 1}, {"id": "P14", "name": "Toolbar_First", "value": 1}, {"id": "P15", "name": "Participant ID", "value": "P15"}, {"id": "P15", "name": "Identify Errors:", "value": 4}, {"id": "P15", "name": "Fix Errors:", "value": 5}, {"id": "P15", "name": "Easier to Fix:", "value": 1}, {"id": "P15", "name": "Faster to Fix:", "value": 1}, {"id": "P15", "name": "Easier on Phone:", "value": 1}, {"id": "P15", "name": "Easier on Tablet:", "value": 1}, {"id": "P15", "name": "Device Preference:", "value": 5}, {"id": "P15", "name": "Tablet_First", "value": 1}, {"id": "P15", "name": "Toolbar_First", "value": 0}, {"id": "P16", "name": "Participant ID", "value": "P16"}, {"id": "P16", "name": "Identify Errors:", "value": 1}, {"id": "P16", "name": "Fix Errors:", "value": 3}, {"id": "P16", "name": "Easier to Fix:", "value": 2}, {"id": "P16", "name": "Faster to Fix:", "value": 2}, {"id": "P16", "name": "Easier on Phone:", "value": 1}, {"id": "P16", "name": "Easier on Tablet:", "value": 4}, {"id": "P16", "name": "Device Preference:", "value": 5}, {"id": "P16", "name": "Tablet_First", "value": 0}, {"id": "P16", "name": "Toolbar_First", "value": 1}, {"id": "P17", "name": "Participant ID", "value": "P17"}, {"id": "P17", "name": "Identify Errors:", "value": 3}, {"id": "P17", "name": "Fix Errors:", "value": 2}, {"id": "P17", "name": "Easier to Fix:", "value": 2}, {"id": "P17", "name": "Faster to Fix:", "value": 2}, {"id": "P17", "name": "Easier on Phone:", "value": 1}, {"id": "P17", "name": "Easier on Tablet:", "value": 3}, {"id": "P17", "name": "Device Preference:", "value": 2}, {"id": "P17", "name": "Tablet_First", "value": 0}, {"id": "P17", "name": "Toolbar_First", "value": 0}]}, "height": 175, "layer": [{"data": {"name": "data-4fe62194e0628f05faa71d2e19ccd79a"}, "encoding": {"size": {"aggregate": "count", "legend": {"offset": 75, "title": "Number of ratings"}, "type": "quantitative"}, "tooltip": [{"aggregate": "count", "title": "Number of ratings", "type": "quantitative"}], "x": {"field": "value", "title": null, "type": "quantitative"}, "y": {"axis": {"domain": false, "grid": true, "labelFontWeight": "bold", "offset": 50, "ticks": false, "title": null}, "field": "name", "type": "nominal"}}, "mark": {"color": "#6EB4FD", "type": "circle"}, "transform": [{"filter": "(((datum.name !== \u0027Toolbar_First\u0027) \u0026\u0026 (datum.name !== \u0027Tablet_First\u0027)) \u0026\u0026 (datum.name !== \u0027Participant ID\u0027))"}]}, {"data": {"name": "data-043711543f32bfffffb6dc606686cfc1"}, "encoding": {"x": {"axis": {"format": ".0f", "grid": false, "values": [1, 2, 3, 4, 5]}, "field": "median", "scale": {"domain": [0, 6]}, "type": "quantitative"}, "y": {"axis": {"domain": false, "grid": true, "labelFontWeight": "bold", "offset": 50, "ticks": false, "title": null}, "field": "name", "type": "nominal"}}, "mark": {"color": "black", "type": "tick"}}, {"data": {"name": "data-043711543f32bfffffb6dc606686cfc1"}, "encoding": {"text": {"field": "lo", "type": "nominal"}, "y": {"axis": {"domain": false, "grid": true, "labelFontWeight": "bold", "offset": 50, "ticks": false, "title": null}, "field": "name", "type": "nominal"}}, "mark": {"align": "right", "type": "text", "x": -5}}, {"data": {"name": "data-043711543f32bfffffb6dc606686cfc1"}, "encoding": {"text": {"field": "hi", "type": "nominal"}, "y": {"axis": {"domain": false, "grid": true, "labelFontWeight": "bold", "offset": 50, "ticks": false, "title": null}, "field": "name", "type": "nominal"}}, "mark": {"align": "left", "type": "text", "x": 255}}], "title": "Questionnaire Ratings", "width": 250};
        let description = "Esta es una simple descripcion"
        let embedOpt = {"mode": "vega-lite"};
        let defaultScheme = null
        if (spec.encoding.hasOwnProperty('color')) {
            if (spec.encoding.color.hasOwnProperty('scale')) {
                defaultScheme = spec.encoding.color.scale
            } else {
                spec.encoding.color["scale"] = {"scheme": "blues"}
                defaultScheme = spec.encoding.color["scale"] = {"scheme": "blues"}
            }
        }
        if(!spec.hasOwnProperty("description")){
            spec.description=description
        }

    </script>

    <!--  Auxiliar functions-->
    <script>
        function showError(el, error) {
            el.innerHTML = ('<div style="color:red;">'
                + '<p>JavaScript Error: ' + error.message + '</p>'
                + "<p>This usually means there's a typo in your chart specification. "
                + "See the javascript console for the full traceback.</p>"
                + '</div>');
            throw error;
        }

        function changeHeight() {
            let newHeight = $heightGraphInput.val();
            spec["height"] = newHeight

            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
        }

        function changeWidth() {
            let newWidth = $widthGraphInput.val();
            spec["width"] = newWidth

            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
        }

        function biggerFontSize() {
            fontSizes.sm += 2
            fontSizes.md += 2
            fontSizes.lg += 2
            // change axis size
            spec.config['axis'] = {...spec.config.axis, 'labelFontSize': fontSizes.sm, 'titleFontSize': fontSizes.md}
            // change title size
            spec.config['title'] = {...spec.config.title, 'fontSize': fontSizes.lg}
            // change legend size
            spec.config['legend'] = {
                ...spec.config.legend,
                'labelFontSize': fontSizes.sm,
                'titleFontSize': fontSizes.md
            }
            // change text mark size
            spec.config['text'] = {...spec.config.text, 'fontSize': fontSizes.sm}
            // change header size
            spec.config['header'] = {
                ...spec.config.header,
                'labelFontSize': fontSizes.sm,
                'titleFontSize': fontSizes.md
            }


            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));

        }

        function smallerFontSize() {
            fontSizes.sm -= 2
            fontSizes.md -= 2
            fontSizes.lg -= 2
            // change axis size
            spec.config['axis'] = {...spec.config.axis, 'labelFontSize': fontSizes.sm, 'titleFontSize': fontSizes.md}
            // change title size
            spec.config['title'] = {...spec.config.title, 'fontSize': fontSizes.lg}
            // change legend size
            spec.config['legend'] = {
                ...spec.config.legend,
                'labelFontSize': fontSizes.sm,
                'titleFontSize': fontSizes.md
            }
            // change text mark size
            spec.config['text'] = {...spec.config.text, 'fontSize': fontSizes.sm}
            // change header size
            spec.config['header'] = {
                ...spec.config.header,
                'labelFontSize': fontSizes.sm,
                'titleFontSize': fontSizes.md
            }
            
            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));

        }
    </script>
    
    <!-- Main sript -->
    <script>
        // Color scheme selector
        $(document).ready(function () {
            if (defaultScheme != null) {
                $('#selector').change(function () {
                    var opcionSeleccionada = $(this).val();
                    switch (opcionSeleccionada) {
                        case 'option1':
                            spec.encoding.color.scale = defaultScheme
                            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
                            break;
                        case 'option2':

                            spec.encoding.color.scale = {"scheme": "category20b"}
                            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
                            break;
                        case 'option3':
                            spec.encoding.color.scale = {"scheme": "viridis"}
                            vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
                            break;
                        default:
                            console.log("The selected option does not correspond any color scheme")
                            break;

                    }

                });
            }
        });
        
        vegaEmbed("#chart", spec, embedOpt).catch(error => showError(el, error));
        $heightGraphInput.on("input", changeHeight);
        $widthGraphInput.on("input", changeWidth);
        $buttonIncrease.on("click", biggerFontSize);
        $buttonDecrease.on("click", smallerFontSize);

    </script>
</body>
</html>

